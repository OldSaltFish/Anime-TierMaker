(()=>{"use strict";var e={430:function(e,t,r){e.exports=r.p+"static/image/logo.96f93525.avif"},700:function(e,t,r){var i=r(927),l=r(247),n=(0,l.XK)('<div class="w-24 m-1 flex flex-col items-center cursor-move bg-white rounded-md shadow-md overflow-hidden relative"><div class="w-full h-24 overflow-hidden"><img class="w-full h-full object-cover"></div><div class="p-1 text-center text-xs w-full truncate">'),o=(0,l.XK)(`<button class="absolute top-0 right-0 bg-red-500 text-white w-6 h-6 flex items-center justify-center rounded-bl-md z-10 opacity-90 hover:opacity-100"title=\u{5220}\u{9664}>\xd7`);let a=e=>{var t,r,a,d,s;let[u,c]=(0,i.gQ)(!1),g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZWVlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiM5OTk5OTkiPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg==",f=t=>{t.stopPropagation(),t.preventDefault(),e.onDelete&&e.onDelete(e.item.id)};return a=(r=(t=n()).firstChild).firstChild,d=r.nextSibling,t.addEventListener("mouseleave",()=>c(!1)),t.addEventListener("mouseenter",()=>c(!0)),(0,l.Oo)(t,"dragend",t=>{let r=t.currentTarget;if(r.classList.remove("dragging"),"true"===r.dataset.hasPlaceholder){let t=document.querySelector(`.bangumi-placeholder[data-placeholder-for="${e.item.id}"]`);t&&t.parentNode&&t.parentNode.removeChild(t),delete r.dataset.hasPlaceholder}}),(0,l.Oo)(t,"dragstart",t=>{if(!t.dataTransfer)return;let r={id:e.item.id,sourceContainerId:e.containerId,type:"BANGUMI"};t.dataTransfer.setData("application/json",JSON.stringify(r)),t.dataTransfer.effectAllowed="move";let i=t.currentTarget,l=i.getBoundingClientRect();t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(i,l.width/2,l.height/2),setTimeout(()=>{i.classList.add("dragging")},0),i.dataset.hasPlaceholder="true"}),(0,l.P$)(t,"draggable",!0),(0,l.$T)(t,(s=(0,l.X$)(()=>!!(u()&&e.onDelete)),()=>{var e;return s()&&(e=o(),(0,l.Oo)(e,"click",f,!0),e)}),r),a.addEventListener("error",e=>{e.target instanceof HTMLImageElement&&(e.target.src=g)}),(0,l.$T)(d,()=>e.item.title),(0,i.F3)(r=>{var i=e.item.title,n=e.item.id,o=e.item.coverBase64||g,d=e.item.title;return i!==r.e&&(0,l.P$)(t,"title",r.e=i),n!==r.t&&(0,l.P$)(t,"data-id",r.t=n),o!==r.a&&(0,l.P$)(a,"src",r.a=o),d!==r.o&&(0,l.P$)(a,"alt",r.o=d),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t};(0,l.Qj)(["click"]);var d=(0,l.XK)('<div><input type=text class="border border-gray-300 rounded px-2 py-1 flex-1 w-full text-center"autofocus>'),s=(0,l.XK)(`<div><div><button class="hidden group-hover:block text-gray-400 w-6 h-6 rounded-full border border-white mt-2 flex items-center justify-center overflow-hidden"title=\u{66F4}\u{6539}\u{989C}\u{8272}><div class="w-full h-full"></div></button></div><div>`),u=(0,l.XK)('<div class="font-bold text-black text-lg cursor-pointer flex-1 text-center">'),c=(0,l.XK)(`<div class="absolute z-10 bg-gray-800 shadow-lg rounded-md p-3 mt-2 border border-gray-700 text-white"><div class="flex justify-between items-center mb-2"><span class=font-medium>\u{9009}\u{62E9}\u{989C}\u{8272}</span><button class="text-gray-500 hover:text-gray-700">\xd7</button></div><div class="flex flex-col gap-2"><div class="grid grid-cols-5 gap-2 mb-2"></div><div class="flex items-center gap-2"><input type=color class="w-8 h-8 cursor-pointer"title=\u{81EA}\u{5B9A}\u{4E49}\u{989C}\u{8272}><input type=text class="border border-gray-300 rounded px-2 py-1 flex-1"placeholder=#RRGGBB>`),g=(0,l.XK)('<button class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center">');let f=e=>{var t,r,n,o,f,p;let[m,v]=(0,i.gQ)(e.tier.name),b=e=>{v(e.target.value)},h=()=>{e.onEditName(e.tier.id,m()),e.onCancelEditName()},x=t=>{let r=t.target;e.onColorChange(e.tier.id,r.value)};return o=(n=(r=(t=s()).firstChild).firstChild).firstChild,f=r.nextSibling,(0,l.$T)(r,(0,i.LM)(i.di,{get when(){return e.isEditingName},get fallback(){var y;return(y=u()).addEventListener("dragstart",t=>{t.dataTransfer.setData("application/json",JSON.stringify({id:e.tier.id,type:"TIER"})),t.stopPropagation()}),(0,l.Oo)(y,"click",e.onStartEditName,!0),(0,l.P$)(y,"draggable",!0),(0,l.$T)(y,()=>e.tier.name),y},get children(){var w=d(),C=w.firstChild;return C.$$keydown=t=>{"Enter"===t.key?h():"Escape"===t.key&&e.onCancelEditName()},C.addEventListener("blur",h),C.$$input=b,(0,i.F3)(()=>(0,l.ok)(w,`flex ${e.isWideScreen?"flex-col":"flex-row"} items-center flex-1 gap-2`)),(0,i.F3)(()=>C.value=m()),w}}),n),(0,l.Oo)(n,"click",e.onOpenColorPicker,!0),(0,l.$T)(r,(p=(0,l.X$)(()=>!!e.showColorPicker),()=>{var t,r,n,o,a,d;return p()&&(n=(r=(t=c()).firstChild).firstChild.nextSibling,d=(a=(o=r.nextSibling.firstChild).nextSibling.firstChild).nextSibling,(0,l.Oo)(n,"click",e.onCloseColorPicker,!0),(0,l.$T)(o,()=>["#c62828","#e65100","#f57f17","#2e7d32","#1565c0","#6a1b9a","#8e0000","#bf360c","#ff6f00","#1b5e20","#0d47a1","#4a148c","#b71c1c","#e64a19","#ffa000","#33691e","#01579b","#424242","#616161","#757575"].map(t=>{var r;return(r=g()).$$click=()=>{var r;e.onColorChange(e.tier.id,t),null==(r=e.onCloseColorPicker)||r.call(e)},null!=t?r.style.setProperty("background-color",t):r.style.removeProperty("background-color"),(0,l.P$)(r,"title",t),r})),a.$$input=x,d.$$input=t=>{let r=t.target;/^#[0-9A-Fa-f]{0,6}$/.test(r.value)&&e.onColorChange(e.tier.id,r.value)},(0,i.F3)(()=>a.value=e.tier.color),(0,i.F3)(()=>d.value=e.tier.color),t)}),null),f.addEventListener("dragleave",e=>{e.currentTarget.classList.remove("tier-drop-indicator")}),f.addEventListener("dragenter",e=>{var t;let r=null==(t=e.dataTransfer)?void 0:t.getData("application/json");r&&"TIER"===JSON.parse(r).type&&e.currentTarget.classList.add("tier-drop-indicator")}),f.addEventListener("drop",t=>{let r;console.log("handleDrop"),t.preventDefault();try{let e=t.dataTransfer.getData("application/json");if(!e)return void console.error("No drag data found");r=JSON.parse(e)}catch(e){console.error("Failed to parse drag data:",e);return}if("TIER"===r.type){t.currentTarget.classList.remove("tier-drop-indicator"),console.log(`\u{68AF}\u{5EA6}\u{62D6}\u{653E}: ${r.id} \u{4ECE} ${r.sourceContainerId||"tier"} \u{5230} ${e.tier.id}`),e.onDrop(r.id,"tier",e.tier.id);return}if("BANGUMI"===r.type){let i,l=t.currentTarget.querySelectorAll("[draggable=true]"),n=t.clientX,o=t.clientY,a=1/0,d=null;for(let t=0;t<l.length;t++){let s=l[t];if(s.getAttribute("data-id")===r.id)continue;let u=s.getBoundingClientRect(),c=u.left+u.width/2,g=u.top+u.height/2,f=Math.sqrt(Math.pow(n-c,2)+Math.pow(o-g,2));f<a&&(a=f,d=s,i=e.isWideScreen&&n<c||!e.isWideScreen&&o>g?t:t+1)}if(d){let e=document.querySelector(".bangumi-placeholder");if(e){let t=d.getBoundingClientRect();e.style.left=`${t.left}px`,e.style.top=`${t.top}px`}}e.onDrop(r.id,r.sourceContainerId,e.tier.id,i)}else e.onDrop(r.id,r.sourceContainerId,e.tier.id)}),f.addEventListener("dragover",e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),(0,l.$T)(f,(0,i.LM)(i.U2,{get each(){return e.tier.items},children:t=>(0,i.LM)(a,{item:t,get containerId(){return e.tier.id}})})),(0,i.F3)(i=>{var n=`flex ${e.isWideScreen?"flex-row":"flex-col"} border-b border-gray-300 tier-container`,a=`${e.isWideScreen?"w-24 min-w-24":"w-full"} flex group ${e.isWideScreen?"flex-col justify-center items-center":"flex-row items-center"} p-2 relative`,d=e.tier.color,s=e.tier.color,u=`flex flex-wrap min-h-128px bg-gray-800 ${e.isWideScreen?"flex-1":"w-full"}`,c=e.tier.id;return n!==i.e&&(0,l.ok)(t,i.e=n),a!==i.t&&(0,l.ok)(r,i.t=a),d!==i.a&&(null!=(i.a=d)?r.style.setProperty("background-color",d):r.style.removeProperty("background-color")),s!==i.o&&(null!=(i.o=s)?o.style.setProperty("background-color",s):o.style.removeProperty("background-color")),u!==i.i&&(0,l.ok)(f,i.i=u),c!==i.n&&(0,l.P$)(f,"data-container-id",i.n=c),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),t};(0,l.Qj)(["input","keydown","click"]);var p=(0,l.XK)(`<div class=h-full><h2 class="text-xl font-bold mb-2 text-gray-100">\u{672A}\u{5206}\u{7C7B}\u{756A}\u{5267}</h2><div class="flex flex-wrap min-h-32 border border-gray-600 rounded-md bg-gray-800 max-h-[70vh] overflow-y-auto"data-container-id=unassigned>`),m=(0,l.XK)(`<div class="w-full text-center text-gray-500 py-4">\u{6CA1}\u{6709}\u{672A}\u{5206}\u{7C7B}\u{7684}\u{756A}\u{5267}`);let v=e=>{var t,r,n;return(r=(t=p()).firstChild.nextSibling).addEventListener("drop",t=>{t.preventDefault();let r=JSON.parse(t.dataTransfer.getData("application/json"));if(e.allowReordering&&"unassigned"===r.sourceContainerId){let i,l=t.currentTarget.querySelectorAll("[draggable=true]"),n=t.clientX,o=t.clientY,a=1/0,d=null;for(let e=0;e<l.length;e++){let t=l[e];if(t.getAttribute("data-id")===r.id)continue;let s=t.getBoundingClientRect(),u=s.left+s.width/2,c=Math.sqrt(Math.pow(n-u,2)+Math.pow(o-(s.top+s.height/2),2));c<a&&(a=c,d=t,i=n<u?e:e+1)}if(d){let e=document.querySelector(".bangumi-placeholder");if(e){let t=d.getBoundingClientRect();e.style.left=`${t.left}px`,e.style.top=`${t.top}px`}}e.onDrop(r.id,r.sourceContainerId,"unassigned",i)}else e.onDrop(r.id,r.sourceContainerId,"unassigned")}),r.addEventListener("dragover",e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),(0,l.$T)(r,(0,i.LM)(i.U2,{get each(){return e.items},children:(t,r)=>(0,i.LM)(a,{item:t,containerId:"unassigned",onDelete:()=>e.items.splice(r(),1)})}),null),(0,l.$T)(r,(n=(0,l.X$)(()=>0===e.items.length),()=>n()&&m()),null),t};var b=r(733),h=r.n(b),x=r(162),y=r(762),w=r.n(y),C=(0,l.XK)(`<div><div class="flex flex-col gap-2"><div><label for=import-file class="bg-blue-500 text-white px-3 py-1 rounded cursor-pointer hover:bg-blue-600 block text-center text-sm">\u{5BFC}\u{5165}JSON</label><input id=import-file type=file accept=.json class=hidden></div><button class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm">\u{5BFC}\u{51FA}\u{4E3A}ZIP</button><button class="bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600 text-sm">`),$=(0,l.XK)('<div class="mt-2 text-red-500 text-sm">');let k=e=>{var t,r,n,o,a,d;let[s,u]=(0,i.gQ)(null),[c,g]=(0,i.gQ)(!1),f=async t=>{var r;let i=t.target,l=null==(r=i.files)?void 0:r[0];if(l)try{let t=await l.text(),r=JSON.parse(t);if(!r.bangumis||!Array.isArray(r.bangumis))throw Error("无效的数据格式：缺少bangumis数组");for(let e of r.bangumis)if(!e.id||!e.title||!e.coverBase64)throw Error("无效的番剧数据：缺少必要字段");e.onImport(r),u(null),i.value=""}catch(e){console.error("导入错误:",e),u(`\u{5BFC}\u{5165}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`)}},p=async()=>{try{let t=new(h()),r={tiers:e.tiers.map(e=>({id:e.id,name:e.name,color:e.color,items:e.items.map(e=>e.id)}))};t.file("tiers.json",JSON.stringify(r,null,2)),e.tiers.forEach(e=>{if(0===e.items.length)return;let r=`
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - TierMaker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    .tier-header {
      background-color: ${e.color};
      color: white;
      padding: 10px;
      font-size: 24px;
      font-weight: bold;
      border-radius: 5px 5px 0 0;
    }
    .tier-content {
      display: flex;
      flex-wrap: wrap;
      padding: 10px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      border-top: none;
      border-radius: 0 0 5px 5px;
    }
    .bangumi-item {
      width: 120px;
      margin: 10px;
      background: white;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .bangumi-cover {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }
    .bangumi-title {
      padding: 5px;
      text-align: center;
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  </style>
</head>
<body>
  <div class="tier-header">${e.name}</div>
  <div class="tier-content">
    ${e.items.map(e=>`
      <div class="bangumi-item">
        <img class="bangumi-cover" src="${e.coverBase64}" alt="${e.title}">
        <div class="bangumi-title">${e.title}</div>
      </div>
    `).join("")}
  </div>
</body>
</html>
        `;t.file(`${e.name}.html`,r)});let i=await t.generateAsync({type:"blob"});(0,x.saveAs)(i,"tier-maker-export.zip"),u(null)}catch(e){console.error("导出错误:",e),u(`\u{5BFC}\u{51FA}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`)}},m=async()=>{try{g(!0),u(null);let e=document.querySelector("#tiers"),t=e.querySelectorAll("button"),r=[];t.forEach(e=>{r.push(e.style.display),e.style.display="none"});let i=await w()(e,{scale:2,logging:!1,useCORS:!0,allowTaint:!0,backgroundColor:null});t.forEach((e,t)=>{e.style.display=r[t]??""});let l=i.toDataURL("image/png"),n=document.createElement("a");n.download="tier-maker-screenshot.png",n.href=l,n.click(),g(!1)}catch(e){console.error("截图导出错误:",e),u(`\u{622A}\u{56FE}\u{5BFC}\u{51FA}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`),g(!1)}};return n=(r=(t=C()).firstChild.firstChild).firstChild.nextSibling,a=(o=r.nextSibling).nextSibling,n.addEventListener("change",f),o.$$click=p,a.$$click=m,(0,l.$T)(a,()=>c()?"导出中...":"导出截图"),(0,l.$T)(t,(d=(0,l.X$)(()=>!!s()),()=>{var e;return d()&&(e=$(),(0,l.$T)(e,s),e)}),null),(0,i.F3)(t=>{var r=e.tiers.every(e=>0===e.items.length),i=e.tiers.every(e=>0===e.items.length)||c();return r!==t.e&&(o.disabled=t.e=r),i!==t.t&&(a.disabled=t.t=i),t},{e:void 0,t:void 0}),t};(0,l.Qj)(["click"]);var E=(0,l.XK)(`<div class="mt-2 border border-gray-600 rounded overflow-hidden"><img alt=\u{9884}\u{89C8} class="w-full h-40 object-contain bg-gray-900">`),T=(0,l.XK)('<div class="mb-4 text-red-500">'),I=(0,l.XK)(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-gray-800 rounded-lg p-6 w-full max-w-md"><h2 class="text-xl font-bold mb-4 text-gray-100">\u{6DFB}\u{52A0}\u{65B0}\u{756A}\u{5267}</h2><form><div class=mb-4><label class="block text-gray-300 mb-2"for=title>\u{6807}\u{9898} (\u{53EF}\u{9009})</label><input id=title type=text class="w-full px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:outline-none focus:border-blue-500"placeholder=\u{8F93}\u{5165}\u{756A}\u{5267}\u{6807}\u{9898}></div><div class=mb-4><label class="block text-gray-300 mb-2"for=image>\u{5C01}\u{9762}\u{56FE}\u{7247} <span class=text-red-500>*</span></label><input id=image type=file accept=image/* class="w-full px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:outline-none focus:border-blue-500"></div><div class="flex justify-end gap-2"><button type=button class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">\u{53D6}\u{6D88}</button><button type=submit class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">\u{6DFB}\u{52A0}`);let A=e=>{let[t,r]=(0,i.gQ)(""),[n,o]=(0,i.gQ)(""),[a,d]=(0,i.gQ)(""),s=e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(!r)return void d("请选择一个图片文件");if(!r.type.startsWith("image/"))return void d("请选择有效的图片文件");let i=new FileReader;i.onload=e=>{var t;o(null==(t=e.target)?void 0:t.result),d("")},i.onerror=()=>{d("读取图片失败，请重试")},i.readAsDataURL(r)},u=i=>{if(i.preventDefault(),!n())return void d("请上传一张图片");let l={id:`bangumi-${Date.now()}`,title:t()||"未命名番剧",coverBase64:n()};e.onAdd(l),r(""),o(""),d(""),e.onClose()},c=()=>{r(""),o(""),d(""),e.onClose()};return(0,i.LM)(i.di,{get when(){return e.isOpen},get children(){var g=I(),f=g.firstChild.firstChild.nextSibling,p=f.firstChild,m=p.firstChild.nextSibling,v=p.nextSibling,b=v.firstChild.nextSibling,h=v.nextSibling,x=h.firstChild;return f.addEventListener("submit",u),m.$$input=e=>r(e.currentTarget.value),b.addEventListener("change",s),(0,l.$T)(v,(0,i.LM)(i.di,{get when(){return n()},get children(){var y=E(),w=y.firstChild;return(0,i.F3)(()=>(0,l.P$)(w,"src",n())),y}}),null),(0,l.$T)(f,(0,i.LM)(i.di,{get when(){return a()},get children(){var C=T();return(0,l.$T)(C,a),C}}),h),x.$$click=c,(0,i.F3)(()=>m.value=t()),g}})};(0,l.Qj)(["input","click"]);var P=r(110),S=(0,l.XK)(`<div class="bg-gray-800 p-3 rounded-lg shadow-lg border border-gray-700 flex flex-col gap-2 mb-2 floating-menu-content"><button class="bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-700 text-sm w-full">\u{6DFB}\u{52A0}\u{68AF}\u{5EA6}`),D=(0,l.XK)(`<div class="mx-auto px-1 py-2 bg-gray-900 rounded-lg"><div class=flex><img class=h-42px alt><h1 class="text-2xl font-bold mb-1 text-gray-200 bg-gray-800 p-2 rounded">Anime TierMaker</h1></div><div class="fixed z-50"><div class="flex flex-col items-end gap-2 floating-menu-container"><button class="bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg floating-menu-button"id=expand-menu-button></button><button class="bg-green-600 hover:bg-green-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg floating-menu-button mt-2"title=\u{6DFB}\u{52A0}\u{756A}\u{5267} id=add-bangumi-button>+</button></div></div><div><div></div><div id=tiers>`),F=(0,l.XK)(`<div class=relative><button class="absolute top-2 right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center hover:bg-red-600"title=\u{5220}\u{9664}\u{68AF}\u{5EA6}>\xd7`);let L=[{id:"tier-s",name:"S",color:"#FC7D82",items:[]},{id:"tier-a",name:"A",color:"#BCFF81",items:[]},{id:"tier-b",name:"B",color:"#FBFF82",items:[]},{id:"tier-c",name:"C",color:"#FCC082",items:[]},{id:"tier-d",name:"D",color:"#FBE182",items:[]}],j=()=>{var e,t,n,o,a,d,s,u,c,g;let p=(0,P.Ne)("(min-width: 1024px)"),[m,b]=(0,i.gQ)({tiers:[...L],unassignedItems:[],isEditingTierName:null,showColorPicker:!1,editingTierColor:null}),[h,x]=(0,i.gQ)(!1),[y,w]=(0,i.gQ)({right:"1rem",bottom:"33%"}),[C,$]=(0,i.gQ)(!1),E=e=>{b(t=>({...t,unassignedItems:e.bangumis,tiers:t.tiers.map(e=>({...e,items:[]}))}))},T=(e,t,r,i)=>{(t!==r||void 0!==i)&&b(l=>{let n;if("unassigned"===t)n=l.unassignedItems.find(t=>t.id===e);else{let r=l.tiers.find(e=>e.id===t);n=null==r?void 0:r.items.find(t=>t.id===e)}if(!n)return l;let o={...l};if("unassigned"===t?o.unassignedItems=l.unassignedItems.filter(t=>t.id!==e):o.tiers=l.tiers.map(r=>r.id===t?{...r,items:r.items.filter(t=>t.id!==e)}:r),"unassigned"===r)if(void 0!==i){let e=[...o.unassignedItems];e.splice(i,0,n),o.unassignedItems=e}else o.unassignedItems=[...o.unassignedItems,n];else o.tiers=o.tiers.map(e=>{if(e.id===r)if(void 0===i)return{...e,items:[...e.items,n]};else{let t=[...e.items];return t.splice(i,0,n),{...e,items:t}}return e});return o})},I=(e,t)=>{b(r=>({...r,tiers:r.tiers.map(r=>r.id===e?{...r,name:t}:r)}))},j=(e,t)=>{b(r=>({...r,tiers:r.tiers.map(r=>r.id===e?{...r,color:t}:r)}))},M=()=>{b(e=>({...e,showColorPicker:!1,editingTierColor:null}))},B=()=>{b(e=>({...e,isEditingTierName:null}))},O=()=>{let e=`tier-${Date.now()}`;b(t=>({...t,tiers:[...t.tiers,{id:e,name:"新梯度",color:"#808080",items:[]}]}))};return n=(t=(e=D()).firstChild).firstChild,s=(d=(a=(o=t.nextSibling).firstChild).firstChild).nextSibling,g=(c=(u=o.nextSibling).firstChild).nextSibling,a.style.setProperty("cursor","move"),(0,l.$T)(a,(0,i.LM)(i.di,{get when(){return h()},get children(){var N=S(),X=N.firstChild;return(0,l.$T)(N,(0,i.LM)(k,{onImport:E,get tiers(){return m().tiers}}),X),X.$$click=O,N}}),d),d.$$click=()=>x(!h()),(0,l.$T)(d,()=>h()?"\xd7":"≡"),s.$$click=()=>$(!0),(0,l.$T)(c,(0,i.LM)(v,{get items(){return m().unassignedItems},onDrop:T,allowReordering:!0})),(0,l.$T)(g,(0,i.LM)(i.U2,{get each(){return m().tiers},children:(e,t)=>{var r,n;return n=(r=F()).firstChild,(0,l.$T)(r,(0,i.LM)(f,{tier:e,onDrop:(e,t,r,i)=>{if("tier"===t)console.log(`\u{62D6}\u{52A8}\u{68AF}\u{5EA6}: ${e} \u{5230} ${r}`),b(t=>{let i=t.tiers.findIndex(t=>t.id===e),l=t.tiers.findIndex(e=>e.id===r);if(-1===i||-1===l||i===l)return t;let n=[...t.tiers],[o]=n.splice(i,1);return n.splice(l,0,o),{...t,tiers:n}});else T(e,t,r,i)},onEditName:I,onColorChange:j,get isEditingName(){return m().isEditingTierName===e.id},onStartEditName:()=>{var t;return t=e.id,void b(e=>({...e,isEditingTierName:t}))},onCancelEditName:B,onOpenColorPicker:()=>{var t;return t=e.id,void b(e=>({...e,showColorPicker:!0,editingTierColor:t}))},get showColorPicker(){return(0,l.X$)(()=>!!m().showColorPicker)()&&m().editingTierColor===e.id},onCloseColorPicker:M,get isWideScreen(){return p()}}),n),n.$$click=()=>{var t;return t=e.id,void b(e=>{let r=e.tiers.find(e=>e.id===t);if(!r)return e;let i=[...e.unassignedItems,...r.items];return{...e,tiers:e.tiers.filter(e=>e.id!==t),unassignedItems:i}})},r}})),(0,l.$T)(e,(0,i.LM)(A,{get isOpen(){return C()},onClose:()=>$(!1),onAdd:e=>{b(t=>({...t,unassignedItems:[...t.unassignedItems,e]}))}}),null),(0,i.F3)(e=>{var t=r(430),i=y().right,a=y().bottom,s=h()?"收起菜单":"展开菜单",f=p()?"flex gap-4":"flex flex-col gap-4",m=p()?"w-228px sticky top-2 self-start bg-gray-800 rounded":"w-full bg-gray-800 p-2 rounded",v=p()?"flex-1":"w-full";return t!==e.e&&(0,l.P$)(n,"src",e.e=t),i!==e.t&&(null!=(e.t=i)?o.style.setProperty("right",i):o.style.removeProperty("right")),a!==e.a&&(null!=(e.a=a)?o.style.setProperty("bottom",a):o.style.removeProperty("bottom")),s!==e.o&&(0,l.P$)(d,"title",e.o=s),f!==e.i&&(0,l.ok)(u,e.i=f),m!==e.n&&(0,l.ok)(c,e.n=m),v!==e.s&&(0,l.ok)(g,e.s=v),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e};(0,l.Qj)(["click"]),r(106);let M=document.getElementById("root");M&&(0,l.sY)(()=>(0,i.LM)(j,{}),M)}},t={};function r(i){var l=t[i];if(void 0!==l)return l.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,r),n.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=[];r.O=(t,i,l,n)=>{if(i){n=n||0;for(var o=e.length;o>0&&e[o-1][2]>n;o--)e[o]=e[o-1];e[o]=[i,l,n];return}for(var a=1/0,o=0;o<e.length;o++){for(var[i,l,n]=e[o],d=!0,s=0;s<i.length;s++)(!1&n||a>=n)&&Object.keys(r.O).every(e=>r.O[e](i[s]))?i.splice(s--,1):(d=!1,n<a&&(a=n));if(d){e.splice(o--,1);var u=l();void 0!==u&&(t=u)}}return t}})(),r.p="/",(()=>{var e={980:0};r.O.j=t=>0===e[t];var t=(t,i)=>{var l,n,[o,a,d]=i,s=0;if(o.some(t=>0!==e[t])){for(l in a)r.o(a,l)&&(r.m[l]=a[l]);if(d)var u=d(r)}for(t&&t(i);s<o.length;s++)n=o[s],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(u)},i=self.webpackChunkmikan_tierMaker=self.webpackChunkmikan_tierMaker||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i=r.O(void 0,["611"],function(){return r(700)});i=r.O(i)})();