(()=>{"use strict";var e={430:function(e,t,r){e.exports=r.p+"static/image/logo.96f93525.avif"},700:function(e,t,r){var i=r(927),n=r(247),l=(0,n.XK)('<div class="w-24 m-1 flex flex-col items-center cursor-move bg-white rounded-md shadow-md overflow-hidden relative"><div class="w-full h-24 overflow-hidden"><img class="w-full h-full object-cover"></div><div class="p-1 text-center text-xs w-full truncate">'),a=(0,n.XK)(`<button class="absolute top-0 right-0 bg-red-500 text-white w-6 h-6 flex items-center justify-center rounded-bl-md z-10 opacity-90 hover:opacity-100"title=\u{5220}\u{9664}>\xd7`);let o=e=>{var t,r,o,d,s;let[u,c]=(0,i.gQ)(!1),g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZWVlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiM5OTk5OTkiPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg==",f=t=>{t.stopPropagation(),t.preventDefault(),e.onDelete&&e.onDelete(e.item.id)};return o=(r=(t=l()).firstChild).firstChild,d=r.nextSibling,t.addEventListener("mouseleave",()=>c(!1)),t.addEventListener("mouseenter",()=>c(!0)),(0,n.Oo)(t,"dragend",e=>{e.currentTarget.classList.remove("dragging")}),(0,n.Oo)(t,"dragstart",t=>{if(!t.dataTransfer)return;let r={id:e.item.id,sourceContainerId:e.containerId,type:"BANGUMI"};t.dataTransfer.setData("application/json",JSON.stringify(r)),t.dataTransfer.effectAllowed="move";let i=t.currentTarget,n=i.getBoundingClientRect();t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(i,n.width/2,n.height/2),setTimeout(()=>{i.classList.add("dragging")},0),i.dataset.hasPlaceholder="true"}),(0,n.P$)(t,"draggable",!0),(0,n.$T)(t,(s=(0,n.X$)(()=>!!(u()&&e.onDelete)),()=>{var e;return s()&&(e=a(),(0,n.Oo)(e,"click",f,!0),e)}),r),o.addEventListener("error",e=>{e.target instanceof HTMLImageElement&&(e.target.src=g)}),(0,n.$T)(d,()=>e.item.title),(0,i.F3)(r=>{var i=e.item.title,l=e.item.id,a=e.item.coverBase64||g,d=e.item.title;return i!==r.e&&(0,n.P$)(t,"title",r.e=i),l!==r.t&&(0,n.P$)(t,"data-id",r.t=l),a!==r.a&&(0,n.P$)(o,"src",r.a=a),d!==r.o&&(0,n.P$)(o,"alt",r.o=d),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t};(0,n.Qj)(["click"]);var d=(0,n.XK)('<div><input type=text class="border border-gray-300 rounded px-2 py-1 flex-1 w-full text-center"autofocus>'),s=(0,n.XK)(`<div><div><button class="hidden group-hover:block text-gray-400 w-6 h-6 rounded-full border border-white mt-2 flex items-center justify-center overflow-hidden"title=\u{66F4}\u{6539}\u{989C}\u{8272}><div class="w-full h-full"></div></button></div><div>`),u=(0,n.XK)('<div class="font-bold text-black text-lg cursor-pointer flex-1 text-center">'),c=(0,n.XK)(`<div class="absolute z-10 bg-gray-800 shadow-lg rounded-md p-3 mt-2 border border-gray-700 text-white"><div class="flex justify-between items-center mb-2"><span class=font-medium>\u{9009}\u{62E9}\u{989C}\u{8272}</span><button class="text-gray-500 hover:text-gray-700">\xd7</button></div><div class="flex flex-col gap-2"><div class="grid grid-cols-5 gap-2 mb-2"></div><div class="flex items-center gap-2"><input type=color class="w-8 h-8 cursor-pointer"title=\u{81EA}\u{5B9A}\u{4E49}\u{989C}\u{8272}><input type=text class="border border-gray-300 rounded px-2 py-1 flex-1"placeholder=#RRGGBB>`),g=(0,n.XK)('<button class="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center">');let f=e=>{var t,r,l,a,f,v;let[p,m]=(0,i.gQ)(e.tier.name),b=e=>{m(e.target.value)},h=()=>{e.onEditName(e.tier.id,p()),e.onCancelEditName()},x=t=>{let r=t.target;e.onColorChange(e.tier.id,r.value)};return a=(l=(r=(t=s()).firstChild).firstChild).firstChild,f=r.nextSibling,(0,n.$T)(r,(0,i.LM)(i.di,{get when(){return e.isEditingName},get fallback(){var w;return(w=u()).addEventListener("dragstart",t=>{t.dataTransfer.setData("application/json",JSON.stringify({id:e.tier.id,type:"TIER"})),t.stopPropagation()}),(0,n.Oo)(w,"click",e.onStartEditName,!0),(0,n.P$)(w,"draggable",!0),(0,n.$T)(w,()=>e.tier.name),w},get children(){var y=d(),C=y.firstChild;return C.$$keydown=t=>{"Enter"===t.key?h():"Escape"===t.key&&e.onCancelEditName()},C.addEventListener("blur",h),C.$$input=b,(0,i.F3)(()=>(0,n.ok)(y,`flex ${e.isWideScreen?"flex-col":"flex-row"} items-center flex-1 gap-2`)),(0,i.F3)(()=>C.value=p()),y}}),l),(0,n.Oo)(l,"click",e.onOpenColorPicker,!0),(0,n.$T)(r,(v=(0,n.X$)(()=>!!e.showColorPicker),()=>{var t,r,l,a,o,d;return v()&&(l=(r=(t=c()).firstChild).firstChild.nextSibling,d=(o=(a=r.nextSibling.firstChild).nextSibling.firstChild).nextSibling,(0,n.Oo)(l,"click",e.onCloseColorPicker,!0),(0,n.$T)(a,()=>["#c62828","#e65100","#f57f17","#2e7d32","#1565c0","#6a1b9a","#8e0000","#bf360c","#ff6f00","#1b5e20","#0d47a1","#4a148c","#b71c1c","#e64a19","#ffa000","#33691e","#01579b","#424242","#616161","#757575"].map(t=>{var r;return(r=g()).$$click=()=>{var r;e.onColorChange(e.tier.id,t),null==(r=e.onCloseColorPicker)||r.call(e)},(0,n.U0)(r,"background-color",t),(0,n.P$)(r,"title",t),r})),o.$$input=x,d.$$input=t=>{let r=t.target;/^#[0-9A-Fa-f]{0,6}$/.test(r.value)&&e.onColorChange(e.tier.id,r.value)},(0,i.F3)(()=>o.value=e.tier.color),(0,i.F3)(()=>d.value=e.tier.color),t)}),null),f.addEventListener("dragleave",e=>{e.currentTarget.classList.remove("tier-drop-indicator")}),f.addEventListener("dragenter",e=>{var t;let r=null==(t=e.dataTransfer)?void 0:t.getData("application/json");r&&"TIER"===JSON.parse(r).type&&e.currentTarget.classList.add("tier-drop-indicator")}),f.addEventListener("drop",t=>{let r;t.preventDefault();try{let e=t.dataTransfer.getData("application/json");if(!e)return void console.error("No drag data found");r=JSON.parse(e)}catch(e){console.error("Failed to parse drag data:",e);return}if("TIER"===r.type){t.currentTarget.classList.remove("tier-drop-indicator"),console.log(`\u{68AF}\u{5EA6}\u{62D6}\u{653E}: ${r.id} \u{4ECE} ${r.sourceContainerId||"tier"} \u{5230} ${e.tier.id}`),e.onDrop(r.id,"tier",e.tier.id);return}if("BANGUMI"===r.type){let i,n=t.currentTarget.querySelectorAll("[draggable=true]"),l=t.clientX,a=t.clientY,o=1/0;for(let t=0;t<n.length;t++){let d=n[t];if(d.getAttribute("data-id")===r.id)continue;let s=d.getBoundingClientRect(),u=s.left+s.width/2,c=s.top+s.height/2,g=Math.sqrt(Math.pow(l-u,2)+Math.pow(a-c,2));g<o&&(o=g,i=e.isWideScreen&&l<u||!e.isWideScreen&&a>c?t:t+1)}e.onDrop(r.id,r.sourceContainerId,e.tier.id,i)}else e.onDrop(r.id,r.sourceContainerId,e.tier.id)}),f.addEventListener("dragover",e=>e.preventDefault()),(0,n.$T)(f,(0,i.LM)(i.U2,{get each(){return e.tier.items},children:t=>(0,i.LM)(o,{item:t,get containerId(){return e.tier.id}})})),(0,i.F3)(i=>{var l=`flex ${e.isWideScreen?"flex-row":"flex-col"} border-b border-gray-300 tier-container`,o=`${e.isWideScreen?"w-24 min-w-24":"w-full"} flex group ${e.isWideScreen?"flex-col justify-center items-center":"flex-row items-center"} p-2 relative`,d=e.tier.color,s=e.tier.color,u=`flex flex-wrap min-h-128px bg-gray-800 ${e.isWideScreen?"flex-1":"w-full"}`,c=e.tier.id;return l!==i.e&&(0,n.ok)(t,i.e=l),o!==i.t&&(0,n.ok)(r,i.t=o),d!==i.a&&(0,n.U0)(r,"background-color",i.a=d),s!==i.o&&(0,n.U0)(a,"background-color",i.o=s),u!==i.i&&(0,n.ok)(f,i.i=u),c!==i.n&&(0,n.P$)(f,"data-container-id",i.n=c),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),t};(0,n.Qj)(["input","keydown","click"]);var v=(0,n.XK)(`<div class=h-full><h2 class="text-xl font-bold mb-2 text-gray-100">\u{672A}\u{5206}\u{7C7B}\u{756A}\u{5267}</h2><div class="flex flex-wrap min-h-32 border border-gray-600 rounded-md bg-gray-800 max-h-[70vh] overflow-y-auto"data-container-id=unassigned>`),p=(0,n.XK)(`<div class="w-full text-center text-gray-500 py-4">\u{6CA1}\u{6709}\u{672A}\u{5206}\u{7C7B}\u{7684}\u{756A}\u{5267}`);let m=e=>{var t,r,l;return(r=(t=v()).firstChild.nextSibling).addEventListener("drop",t=>{t.preventDefault();let r=JSON.parse(t.dataTransfer.getData("application/json"));if(e.allowReordering&&"unassigned"===r.sourceContainerId){let i,n=t.currentTarget.querySelectorAll("[draggable=true]"),l=t.clientX,a=t.clientY,o=1/0;for(let e=0;e<n.length;e++){let t=n[e];if(t.getAttribute("data-id")===r.id)continue;let d=t.getBoundingClientRect(),s=d.left+d.width/2,u=Math.sqrt(Math.pow(l-s,2)+Math.pow(a-(d.top+d.height/2),2));u<o&&(o=u,i=l<s?e:e+1)}e.onDrop(r.id,r.sourceContainerId,"unassigned",i)}else e.onDrop(r.id,r.sourceContainerId,"unassigned")}),r.addEventListener("dragover",e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),(0,n.$T)(r,(0,i.LM)(i.U2,{get each(){return e.items},children:(t,r)=>(0,i.LM)(o,{item:t,containerId:"unassigned",onDelete:()=>e.items.splice(r(),1)})}),null),(0,n.$T)(r,(l=(0,n.X$)(()=>0===e.items.length),()=>l()&&p()),null),t};var b=r(733),h=r.n(b),x=r(162),w=r(762),y=r.n(w),C=(0,n.XK)(`<div><div class="flex flex-col gap-2"><div><label for=import-file class="bg-blue-500 text-white px-3 py-1 rounded cursor-pointer hover:bg-blue-600 block text-center text-sm">\u{5BFC}\u{5165}JSON</label><input id=import-file type=file accept=.json class=hidden></div><button class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm">\u{5BFC}\u{51FA}\u{4E3A}ZIP</button><button class="bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600 text-sm">`),$=(0,n.XK)('<div class="mt-2 text-red-500 text-sm">');let k=e=>{var t,r,l,a,o,d;let[s,u]=(0,i.gQ)(null),[c,g]=(0,i.gQ)(!1),f=async t=>{var r;let i=t.target,n=null==(r=i.files)?void 0:r[0];if(n)try{let t=await n.text(),r=JSON.parse(t);if(!r||!Array.isArray(r))throw Error("无效的数据格式：缺少bangumis数组");r=r.filter(e=>e.id&&e.title&&e.coverBase64),e.onImport(r),u(null),i.value=""}catch(e){console.error("导入错误:",e),u(`\u{5BFC}\u{5165}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`)}},v=async()=>{try{let t=new(h()),r={tiers:e.tiers.map(e=>({id:e.id,name:e.name,color:e.color,items:e.items.map(e=>e.id)}))};t.file("tiers.json",JSON.stringify(r,null,2)),e.tiers.forEach(e=>{if(0===e.items.length)return;let r=`
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - TierMaker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    .tier-header {
      background-color: ${e.color};
      color: white;
      padding: 10px;
      font-size: 24px;
      font-weight: bold;
      border-radius: 5px 5px 0 0;
    }
    .tier-content {
      display: flex;
      flex-wrap: wrap;
      padding: 10px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      border-top: none;
      border-radius: 0 0 5px 5px;
    }
    .bangumi-item {
      width: 120px;
      margin: 10px;
      background: white;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .bangumi-cover {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }
    .bangumi-title {
      padding: 5px;
      text-align: center;
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  </style>
</head>
<body>
  <div class="tier-header">${e.name}</div>
  <div class="tier-content">
    ${e.items.map(e=>`
      <div class="bangumi-item">
        <img class="bangumi-cover" src="${e.coverBase64}" alt="${e.title}">
        <div class="bangumi-title">${e.title}</div>
      </div>
    `).join("")}
  </div>
</body>
</html>
        `;t.file(`${e.name}.html`,r)});let i=await t.generateAsync({type:"blob"});(0,x.saveAs)(i,"tier-maker-export.zip"),u(null)}catch(e){console.error("导出错误:",e),u(`\u{5BFC}\u{51FA}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`)}},p=async()=>{try{g(!0),u(null);let e=document.querySelector("#tiers"),t=e.querySelectorAll("button"),r=[];t.forEach(e=>{r.push(e.style.display),e.style.display="none"});let i=await y()(e,{scale:2,logging:!1,useCORS:!0,allowTaint:!0,backgroundColor:null});t.forEach((e,t)=>{e.style.display=r[t]??""});let n=i.toDataURL("image/png"),l=document.createElement("a");l.download="tier-maker-screenshot.png",l.href=n,l.click(),g(!1)}catch(e){console.error("截图导出错误:",e),u(`\u{622A}\u{56FE}\u{5BFC}\u{51FA}\u{5931}\u{8D25}: ${e instanceof Error?e.message:"未知错误"}`),g(!1)}};return l=(r=(t=C()).firstChild.firstChild).firstChild.nextSibling,o=(a=r.nextSibling).nextSibling,l.addEventListener("change",f),a.$$click=v,o.$$click=p,(0,n.$T)(o,()=>c()?"导出中...":"导出截图"),(0,n.$T)(t,(d=(0,n.X$)(()=>!!s()),()=>{var e;return d()&&(e=$(),(0,n.$T)(e,s),e)}),null),(0,i.F3)(t=>{var r=e.tiers.every(e=>0===e.items.length),i=e.tiers.every(e=>0===e.items.length)||c();return r!==t.e&&(a.disabled=t.e=r),i!==t.t&&(o.disabled=t.t=i),t},{e:void 0,t:void 0}),t};(0,n.Qj)(["click"]);var E=(0,n.XK)(`<div class="mt-2 border border-gray-600 rounded overflow-hidden"><img alt=\u{9884}\u{89C8} class="w-full h-40 object-contain bg-gray-900">`),T=(0,n.XK)('<div class="mb-4 text-red-500">'),I=(0,n.XK)(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"><div class="bg-gray-800 rounded-lg p-6 w-full max-w-md"><h2 class="text-xl font-bold mb-4 text-gray-100">\u{6DFB}\u{52A0}\u{65B0}\u{756A}\u{5267}</h2><form><div class=mb-4><label class="block text-gray-300 mb-2"for=title>\u{6807}\u{9898} (\u{53EF}\u{9009})</label><input id=title type=text class="w-full px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:outline-none focus:border-blue-500"placeholder=\u{8F93}\u{5165}\u{756A}\u{5267}\u{6807}\u{9898}></div><div class=mb-4><label class="block text-gray-300 mb-2"for=image>\u{5C01}\u{9762}\u{56FE}\u{7247} <span class=text-red-500>*</span></label><input id=image type=file accept=image/* class="w-full px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:outline-none focus:border-blue-500"></div><div class="flex justify-end gap-2"><button type=button class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">\u{53D6}\u{6D88}</button><button type=submit class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">\u{6DFB}\u{52A0}`);let A=e=>{let[t,r]=(0,i.gQ)(""),[l,a]=(0,i.gQ)(""),[o,d]=(0,i.gQ)(""),s=e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(!r)return void d("请选择一个图片文件");if(!r.type.startsWith("image/"))return void d("请选择有效的图片文件");let i=new FileReader;i.onload=e=>{var t;a(null==(t=e.target)?void 0:t.result),d("")},i.onerror=()=>{d("读取图片失败，请重试")},i.readAsDataURL(r)},u=i=>{if(i.preventDefault(),!l())return void d("请上传一张图片");let n={id:`bangumi-${Date.now()}`,title:t()||"未命名番剧",coverBase64:l()};e.onAdd(n),r(""),a(""),d(""),e.onClose()},c=()=>{r(""),a(""),d(""),e.onClose()};return(0,i.LM)(i.di,{get when(){return e.isOpen},get children(){var g=I(),f=g.firstChild.firstChild.nextSibling,v=f.firstChild,p=v.firstChild.nextSibling,m=v.nextSibling,b=m.firstChild.nextSibling,h=m.nextSibling,x=h.firstChild;return f.addEventListener("submit",u),p.$$input=e=>r(e.currentTarget.value),b.addEventListener("change",s),(0,n.$T)(m,(0,i.LM)(i.di,{get when(){return l()},get children(){var w=E(),y=w.firstChild;return(0,i.F3)(()=>(0,n.P$)(y,"src",l())),w}}),null),(0,n.$T)(f,(0,i.LM)(i.di,{get when(){return o()},get children(){var C=T();return(0,n.$T)(C,o),C}}),h),x.$$click=c,(0,i.F3)(()=>p.value=t()),g}})};(0,n.Qj)(["input","click"]);var S=r(110),D=(0,n.XK)(`<div class="bg-gray-800 p-3 rounded-lg shadow-lg border border-gray-700 flex flex-col gap-2 mb-2 floating-menu-content"><button class="bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-700 text-sm w-full">\u{6DFB}\u{52A0}\u{68AF}\u{5EA6}`),F=(0,n.XK)(`<div class="mx-auto px-1 py-2 bg-gray-900 rounded-lg"><div class=flex><img class=h-42px alt><h1 class="text-2xl font-bold mb-1 text-gray-200 bg-gray-800 p-2 rounded">Anime TierMaker</h1></div><div class="fixed z-50"><div class="flex flex-col items-end gap-2 floating-menu-container"><button class="bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg floating-menu-button"id=expand-menu-button></button><button class="bg-green-600 hover:bg-green-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg floating-menu-button mt-2"title=\u{6DFB}\u{52A0}\u{756A}\u{5267} id=add-bangumi-button>+</button></div></div><div><div></div><div id=tiers>`),L=(0,n.XK)(`<div class=relative><button class="absolute top-2 right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center hover:bg-red-600"title=\u{5220}\u{9664}\u{68AF}\u{5EA6}>\xd7`);let j=[{id:"tier-s",name:"S",color:"#FC7D82",items:[]},{id:"tier-a",name:"A",color:"#BCFF81",items:[]},{id:"tier-b",name:"B",color:"#FBFF82",items:[]},{id:"tier-c",name:"C",color:"#FCC082",items:[]},{id:"tier-d",name:"D",color:"#FBE182",items:[]},{id:"tier-f",name:"F",color:"#6a1b9a",items:[]}],M=()=>{var e,t,l,a,o,d,s,u,c,g;let v=(0,S.Ne)("(min-width: 1024px)"),[p,b]=(0,i.gQ)({tiers:[...j],unassignedItems:[],isEditingTierName:null,showColorPicker:!1,editingTierColor:null}),[h,x]=(0,i.gQ)(!1),[w,y]=(0,i.gQ)({right:"1rem",bottom:"33%"}),[C,$]=(0,i.gQ)(!1),E=e=>{b(t=>{let r=t.tiers.map(e=>({...e,items:[]})),i=[];return e.forEach(e=>{if(void 0!==e.rating&&e.rating>=0&&e.rating<=5){let t=5-e.rating;t>=0&&t<r.length?r[t].items.push(e):i.push(e)}else i.push(e)}),{...t,unassignedItems:i,tiers:r}})},T=(e,t,r,i)=>{(t!==r||void 0!==i)&&b(n=>{let l;if("unassigned"===t)l=n.unassignedItems.find(t=>t.id===e);else{let r=n.tiers.find(e=>e.id===t);l=null==r?void 0:r.items.find(t=>t.id===e)}if(!l)return n;let a={...l};if("unassigned"!==r){let e=n.tiers.findIndex(e=>e.id===r);-1!==e&&(a.rating=5-e)}let o={...n};if("unassigned"===t?o.unassignedItems=n.unassignedItems.filter(t=>t.id!==e):o.tiers=n.tiers.map(r=>r.id===t?{...r,items:r.items.filter(t=>t.id!==e)}:r),"unassigned"===r)if(void 0!==i){let e=[...o.unassignedItems];e.splice(i,0,a),o.unassignedItems=e}else o.unassignedItems=[...o.unassignedItems,a];else o.tiers=o.tiers.map(e=>{if(e.id===r)if(void 0===i)return{...e,items:[...e.items,a]};else{let t=[...e.items];return t.splice(i,0,a),{...e,items:t}}return e});return o})},I=(e,t)=>{b(r=>({...r,tiers:r.tiers.map(r=>r.id===e?{...r,name:t}:r)}))},M=(e,t)=>{b(r=>({...r,tiers:r.tiers.map(r=>r.id===e?{...r,color:t}:r)}))},P=()=>{b(e=>({...e,showColorPicker:!1,editingTierColor:null}))},B=()=>{b(e=>({...e,isEditingTierName:null}))},O=()=>{let e=`tier-${Date.now()}`;b(t=>({...t,tiers:[...t.tiers,{id:e,name:"新梯度",color:"#808080",items:[]}]}))};return l=(t=(e=F()).firstChild).firstChild,s=(d=(o=(a=t.nextSibling).firstChild).firstChild).nextSibling,g=(c=(u=a.nextSibling).firstChild).nextSibling,(0,n.U0)(o,"cursor","move"),(0,n.$T)(o,(0,i.LM)(i.di,{get when(){return h()},get children(){var N=D(),X=N.firstChild;return(0,n.$T)(N,(0,i.LM)(k,{onImport:E,get tiers(){return p().tiers}}),X),X.$$click=O,N}}),d),d.$$click=()=>x(!h()),(0,n.$T)(d,()=>h()?"\xd7":"≡"),s.$$click=()=>$(!0),(0,n.$T)(c,(0,i.LM)(m,{get items(){return p().unassignedItems},onDrop:T,allowReordering:!0})),(0,n.$T)(g,(0,i.LM)(i.U2,{get each(){return p().tiers},children:(e,t)=>{var r,l;return l=(r=L()).firstChild,(0,n.$T)(r,(0,i.LM)(f,{tier:e,onDrop:(e,t,r,i)=>{if("tier"===t)console.log(`\u{62D6}\u{52A8}\u{68AF}\u{5EA6}: ${e} \u{5230} ${r}`),b(t=>{let i=t.tiers.findIndex(t=>t.id===e),n=t.tiers.findIndex(e=>e.id===r);if(-1===i||-1===n||i===n)return t;let l=[...t.tiers],[a]=l.splice(i,1);return l.splice(n,0,a),{...t,tiers:l}});else T(e,t,r,i)},onEditName:I,onColorChange:M,get isEditingName(){return p().isEditingTierName===e.id},onStartEditName:()=>{var t;return t=e.id,void b(e=>({...e,isEditingTierName:t}))},onCancelEditName:B,onOpenColorPicker:()=>{var t;return t=e.id,void b(e=>({...e,showColorPicker:!0,editingTierColor:t}))},get showColorPicker(){return(0,n.X$)(()=>!!p().showColorPicker)()&&p().editingTierColor===e.id},onCloseColorPicker:P,get isWideScreen(){return v()}}),l),l.$$click=()=>{var t;return t=e.id,void b(e=>{let r=e.tiers.find(e=>e.id===t);if(!r)return e;let i=[...e.unassignedItems,...r.items];return{...e,tiers:e.tiers.filter(e=>e.id!==t),unassignedItems:i}})},r}})),(0,n.$T)(e,(0,i.LM)(A,{get isOpen(){return C()},onClose:()=>$(!1),onAdd:e=>{b(t=>({...t,unassignedItems:[...t.unassignedItems,e]}))}}),null),(0,i.F3)(e=>{var t=r(430),i=w().right,o=w().bottom,s=h()?"收起菜单":"展开菜单",f=v()?"flex gap-4":"flex flex-col gap-4",p=v()?"w-228px sticky top-2 self-start bg-gray-800 rounded":"w-full bg-gray-800 p-2 rounded",m=v()?"flex-1":"w-full";return t!==e.e&&(0,n.P$)(l,"src",e.e=t),i!==e.t&&(0,n.U0)(a,"right",e.t=i),o!==e.a&&(0,n.U0)(a,"bottom",e.a=o),s!==e.o&&(0,n.P$)(d,"title",e.o=s),f!==e.i&&(0,n.ok)(u,e.i=f),p!==e.n&&(0,n.ok)(c,e.n=p),m!==e.s&&(0,n.ok)(g,e.s=m),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),e};(0,n.Qj)(["click"]),r(106);let P=document.getElementById("root");P&&(0,n.sY)(()=>(0,i.LM)(M,{}),P)}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var l=t[i]={exports:{}};return e[i].call(l.exports,l,l.exports,r),l.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=[];r.O=(t,i,n,l)=>{if(i){l=l||0;for(var a=e.length;a>0&&e[a-1][2]>l;a--)e[a]=e[a-1];e[a]=[i,n,l];return}for(var o=1/0,a=0;a<e.length;a++){for(var[i,n,l]=e[a],d=!0,s=0;s<i.length;s++)(!1&l||o>=l)&&Object.keys(r.O).every(e=>r.O[e](i[s]))?i.splice(s--,1):(d=!1,l<o&&(o=l));if(d){e.splice(a--,1);var u=n();void 0!==u&&(t=u)}}return t}})(),r.p="/",(()=>{var e={980:0};r.O.j=t=>0===e[t];var t=(t,i)=>{var n,l,[a,o,d]=i,s=0;if(a.some(t=>0!==e[t])){for(n in o)r.o(o,n)&&(r.m[n]=o[n]);if(d)var u=d(r)}for(t&&t(i);s<a.length;s++)l=a[s],r.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return r.O(u)},i=self.webpackChunkmikan_tierMaker=self.webpackChunkmikan_tierMaker||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i=r.O(void 0,["611"],function(){return r(700)});i=r.O(i)})();